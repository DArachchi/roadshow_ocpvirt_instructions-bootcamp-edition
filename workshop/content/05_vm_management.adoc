:scrollbar:
:toc2:

= Virtual Machine Management Lab

:numbered:

== Introduction to Virtual Machine Management

In this lab, you will learn how to manage the Virtual Machine using the OpenShift Web Console.

.Goals

* Gain experience with VM management using the OpenShift Web Console

=== Virtual Machine Management

==== Controlling virtual machine state

You can stop, start, restart, pause and unpause virtual machines from the web console.

. In the left menu go back to *Virtualization* -> *VirtualMachines*:

. Select the _Virtual Machine_ `fedora02` from the list.

. Press the top-right dropdown *Actions* to list the available 
options:
+
image::images/Pods_Migration/30_VM_Actions_List.png[]
+
.. *Stop*: Starts a graceful shutdown of the _Virtual Machine_.
.. *Restart*: It sends a signal to the operating system to reboot the _Virtual Machine_.
.. *Pause*: The process is frozen without further access to CPU resources and I/O but the memory used by the domain at the hypervisor level will stay allocated.
. Press *Stop* and wait till the _Virtual Machine_ is in state `Stopped`.
+
image::images/Pods_Migration/31_VM_Stopped.png[]
. Clicking on *Actions* the option *Start* appears and the options *Restart* and *Pause* are greyed out. 
+
image::images/Pods_Migration/32_VM_Actions_List_Stopped.png[]

. Press *Start*, and wait for the `Running` status.

. Using the *Actions* menu, press the *Pause* option. The _Virtual Machine_ state will change to `Paused`.
+
image::images/Pods_Migration/33_VM_Actions_Paused.png[]

. Unpause the _Virtual Machine_ using *Actions* and the option *Unpause*.

==== Live Migrate Virtual Machine

In this section, you migrate the VM from one OpenShift node to another without shutting down the VM.

. Navigate to the *Details* tab to see where the worker node is running:
+
image::images/Pods_Migration/17_VM_Info_Node.png[]

. Using the menu *Actions* press *Migrate*
+
image::images/Pods_Migration/19_VM_Dialog_Migrate.png[]

. The VM will change the status to `Migrating`. After some seconds ensure it was moved correctly (check that the worker node name has changed)
+
image::images/Pods_Migration/21_Migrated.png[]

////
// Removing as per Sully - changing resources requires a VM reboot.

=== Resize a Virtual Machine

It is possible to change the resources, CPU and Memory, associated to a _Virtual Machine_ after it is created. 

. In the *Details* tab press in the configuration under `CPU | Memory`
+
image::images/Pods_Migration/35_VM_Resources.png[]

. A dialog will appear to specify new values for the _CPU_ and _Memory_.
+
image::images/Pods_Migration/36_VM_Resources_Dialog.png[]

. Update the _CPU cores_ to `2` and the _Memory_ to `3 GiB` and press *Save*.

. Scrolling up, the _Virtual Machine_ will show this message indicating it has to be rebooted to apply the changes.
+
image::images/Pods_Migration/37_VM_Resources_Warning.png[]

. Using the *Actions* menu, press *Restart* to reboot the instance.
////

== Summary

In this lab, you explored some Virtual Machine Management tasks and you executed a live migration of that VM.
